# Configuración optimizada para pipeline de demanda hotelera Mendoza v2.3
# Fuentes principales: ETI Mendoza + argentinadatos.com

# -------------------------------
# Turismo (ETI - CSVs directos)  
# -------------------------------
eti_aeropuerto:
  dataset_name: "eti_mendoza_aeropuerto_turistas_no_residentes"
  api_url: "https://datos.yvera.gob.ar/dataset/78b880c1-50d5-4a0c-9c87-7350e70548c2/resource/c112ca01-2563-4a48-a8d6-1126af9a5f1d/download/turistas_pernoctes_estadia_media_turistas_no_residentes_por_residencia_aeropuerto_mendoza_trimes.csv"
  type: "direct_csv"
  min_bytes: 2000
  category: "turismo"
  enabled: true

eti_cristo_redentor:
  dataset_name: "eti_mendoza_cristo_redentor_turistas_no_residentes"
  api_url: "https://datos.yvera.gob.ar/dataset/78b880c1-50d5-4a0c-9c87-7350e70548c2/resource/941a5faf-898d-47f5-b889-25e3919bc468/download/turistas_pernoctes_estadia_media_turistas_no_residentes_por_residencia_cristo_redentor_trimestra.csv"
  type: "direct_csv"
  min_bytes: 2000
  category: "turismo"
  enabled: true

# -------------------------------
# Variables económicas principales
# -------------------------------
usd_dolarapi:
  dataset_name: "usd_ars_historico_argentinadatos"
  api_url: "https://api.argentinadatos.com/v1/cotizaciones/dolares/"
  type: "api_json"
  min_bytes: 5000
  description: "Cotización USD histórica desde argentinadatos.com (filtrado por oficial desde 2018)"
  category: "economico"
  enabled: true

# -------------------------------
# Configuración del pipeline
# -------------------------------
defaults:
  timeout_seconds: 180
  chunk_size: 8192
  max_retries: 3
  min_rows_per_table: 3
  enable_small_files: true

validation:
  enable_data_quality_checks: true
  min_rows_per_table: 3
  allow_small_valid_files: true
  small_file_threshold: 5000
  
  # Validaciones específicas por fuente
  eti_validation:
    required_columns: ["indice_tiempo", "turistas_no_residentes"]
    min_records_per_quarter: 1
    
  usd_validation:
    min_price: 10.0
    max_price: 3000.0
    max_daily_change: 50
    require_recent_data: true

# -------------------------------
# Agregación y procesamiento
# -------------------------------
aggregation:
  target_frequency: "quarterly"
  
  usd_aggregation:
    methods: ["mean", "min", "max", "std"]
    calculate_volatility: true
    classify_periods: true
    volatility_threshold: 5.0
  
  tourism_aggregation:
    methods: ["sum", "mean"]
    calculate_growth: true
    seasonal_adjustment: true
    lag_periods: [1, 4]

feature_engineering:
  seasonal_variables: true
  lag_periods: [1, 4]
  
  # Variables derivadas automáticas
  derived_variables:
    usd_categories: ["bajo", "medio", "alto", "muy_alto"]
    tourism_categories: ["muy_bajo", "bajo", "medio", "alto", "muy_alto"]
    volatility_threshold: 5.0
  
  # Variables de eventos específicas de Mendoza
  mendoza_events:
    vendimia_quarter: 1
    winter_vacation_quarter: 3
    high_season_quarters: [1, 3]

# -------------------------------
# Configuración de salida
# -------------------------------
output_config:
  final_dataset_name: "mendoza_turismo_final_con_usd.csv"
  summary_report: true
  feature_matrix: true
  quarterly_aggregation: true
  
  columns_order:
    - "indice_tiempo"
    - "año"
    - "trimestre"
    - "turistas_no_residentes_total"
    - "turistas_aeropuerto"
    - "turistas_cristo"
    - "precio_promedio_usd"
    - "usd_alto"
    - "temporada_alta"
    - "temporada_vendimia"
    - "evento_importante"
    - "es_verano"
    - "es_otoño"
    - "es_invierno"
    - "es_primavera"

# -------------------------------
# Configuración de logs
# -------------------------------
logging_config:
  enable_detailed_logs: true
  log_data_samples: true
  max_sample_rows: 5
  
  track_metrics:
    - "download_success_rate"
    - "data_quality_score"
    - "usd_data_coverage"
    - "tourism_data_completeness"
  fallback_type: "direct_csv"
  min_bytes: 5000
  description: "Datos turísticos INDEC con URL dinámica"
  enabled: false  # Deshabilitado por ahora

# -------------------------------
# Configuración de salida (unificada)
# -------------------------------
output_config:
  final_dataset_name: "mendoza_turismo_final_con_usd.csv"
  summary_report: true
  feature_matrix: true
  quarterly_aggregation: true
  
  # Orden de columnas en dataset final (versión definitiva)
  columns_order:
    - "indice_tiempo"
    - "año"
    - "trimestre"
    - "turistas_no_residentes_total"
    - "turistas_aeropuerto"
    - "turistas_cristo"
    - "precio_promedio_usd"
    - "volatilidad_usd"
    - "precio_min_usd"
    - "precio_max_usd"
    - "temporada_alta"
    - "temporada_vendimia"
    - "evento_importante"
    - "turistas_lag1"
    - "turistas_crecimiento"
    - "usd_alto"
    - "usd_muy_volatil"
    - "es_verano"
    - "es_invierno"
  search_pattern: "turismo.*\\.csv$"
  type: "dynamic_url"
  fallback_type: "direct_csv"
  min_bytes: 5000
  description: "Datos turísticos INDEC con URL dinámica"
  enabled: false  # Deshabilitado por ahora

# -------------------------------
# Configuración de salida NUEVA
# -------------------------------
output_config:
  final_dataset_name: "mendoza_turismo_final_con_usd.csv"
  summary_report: true
  feature_matrix: true
  quarterly_aggregation: true
  
  columns_order:
    - "indice_tiempo"
    - "año"
    - "trimestre"
    - "turistas_no_residentes_total"
    - "turistas_aeropuerto"
    - "turistas_cristo"
    - "precio_promedio_usd"
    - "volatilidad_usd"
    - "clasificacion_usd"
    - "temporada_alta"
    - "temporada_vendimia"
    - "evento_importante"
    - "turistas_crecimiento"
  
  columns_order:
    - "indice_tiempo"
    - "año"
    - "trimestre"
    - "turistas_no_residentes_total"
    - "turistas_aeropuerto"
    - "turistas_cristo"
    - "precio_promedio_usd"
    - "volatilidad_usd"
    - "clasificacion_usd"
    - "temporada_alta"
    - "temporada_vendimia"
    - "evento_importante"
    - "turistas_crecimiento"

