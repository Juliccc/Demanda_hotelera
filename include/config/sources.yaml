# include/config/sources.yaml - Expandido para modelo predictivo

# Fuentes originales (mantener)
open_data_mza:
   dataset_name: "turismo-internacional-total-pais"
   api_url: "https://datos.yvera.gob.ar/dataset/4cbf7d4a-702a-4911-8c1e-717a45214902/resource/fd710cb7-1981-43ea-aba3-7a14c356446b/download/turistas-residentes-serie.csv"
   resource_format: "csv"
   parse: false
   min_bytes: 5000

eti:
  dataset_name: "encuesta_turismo_internacional"
  dataset_url: "https://datos.gob.ar/dataset/turismo-encuesta-turismo-internacional-eti"
  min_bytes: 10000
  dynamic_scraping: true
  type: "dataset_page_scraping"

# NUEVAS FUENTES - Variables económicas críticas
bcra_usd:
  dataset_name: "cotizacion_usd_bcra"
  api_url: "https://api.bcra.gob.ar/estadisticas/v2.0/DatosVariable/1/2020-01-01/2024-12-31"
  description: "Cotización USD oficial BCRA"
  type: "api_json"
  min_bytes: 1000
  headers:
    Accept: "application/json"
  parse_json: true
  date_column: "fecha"
  value_column: "valor"

bcra_inflation:
  dataset_name: "inflacion_mensual_bcra"
  api_url: "https://api.bcra.gob.ar/estadisticas/v2.0/DatosVariable/31/2020-01-01/2024-12-31"
  description: "Inflación mensual BCRA"
  type: "api_json"
  min_bytes: 1000
  headers:
    Accept: "application/json"
  parse_json: true

# Variables climáticas (Mendoza específico)
weather_mendoza:
  dataset_name: "clima_mendoza_historico"
  api_url: "https://api.openweathermap.org/data/2.5/onecall/timemachine"
  description: "Datos climáticos históricos Mendoza"
  type: "api_weather"
  location:
    lat: -32.8895
    lon: -68.8458
  api_key_variable: "OPENWEATHER_API_KEY"  # Variable de Airflow
  enabled: false  # Requiere API key

# Datos económicos adicionales - INDEC
indec_pib:
  dataset_name: "pib_mensual_indec"
  api_url: "https://apis.datos.gob.ar/series/api/series/?ids=143.3_NO_PR_2004_A_21&limit=1000&sort=asc"
  description: "PIB mensual Argentina"
  type: "api_json"
  min_bytes: 2000
  parse_json: true

indec_empleo:
  dataset_name: "tasa_desempleo_indec"
  api_url: "https://apis.datos.gob.ar/series/api/series/?ids=143.3_TL_0_M_26&limit=1000&sort=asc"
  description: "Tasa de desempleo Argentina"
  type: "api_json"
  min_bytes: 1000

# Datos de conectividad aérea
conectividad_aerea:
  dataset_name: "vuelos_mendoza_eana"
  dataset_url: "https://datos.gob.ar/dataset/transporte-operaciones-aeroportuarias"
  description: "Operaciones aeroportuarias - Aeropuerto Mendoza"
  type: "dataset_page_scraping"
  min_bytes: 50000
  dynamic_scraping: true

# Datos de alojamiento específicos Mendoza
alojamiento_mendoza:
  dataset_name: "establecimientos_alojamiento_mendoza"
  api_url: "https://datos.yvera.gob.ar/dataset/sinta-establecimientos-alojamiento-turistico/resource/8fb1b651-7f2c-4b41-acb9-e94eea8e26a0/download/sinta_establecimientos_turisticos_alojamiento.csv"
  description: "Establecimientos de alojamiento turístico"
  type: "direct_csv"
  min_bytes: 10000
  filter_province: "Mendoza"

# Eventos y festivales (datos estructurados)
eventos_mendoza:
  dataset_name: "eventos_turisticos_mendoza"
  manual_data: true
  description: "Eventos turísticos relevantes Mendoza"
  # Estos se pueden hardcodear inicialmente:
  eventos_principales:
    - nombre: "Fiesta Nacional de la Vendimia"
      mes: 3
      impacto: "alto"
      duracion_dias: 15
    - nombre: "Festival Internacional de Cine"
      mes: 10
      impacto: "medio"
      duracion_dias: 7
    - nombre: "Navidad y Año Nuevo"
      mes: [12, 1]
      impacto: "alto"
      duracion_dias: 21
    - nombre: "Vacaciones de Invierno"
      mes: 7
      impacto: "alto"
      duracion_dias: 15

# Datos de precios de commodities (vino/petróleo)
commodities:
  dataset_name: "precios_commodities"
  api_url: "https://api.worldbank.org/v2/country/ARG/indicator/PPGMT.AG?date=2020:2024&format=json"
  description: "Precios de commodities - Banco Mundial"
  type: "api_json"
  enabled: false  # Opcional
  min_bytes: 500

# Datos demográficos y económicos Mendoza
demografia_mendoza:
  dataset_name: "poblacion_mendoza_indec"
  api_url: "https://apis.datos.gob.ar/georef/api/provincias?nombre=Mendoza"
  description: "Datos demográficos Mendoza"
  type: "api_json"
  min_bytes: 500

# Configuración de validación expandida
validation:
  enable_data_quality_checks: true
  min_rows_per_table: 5
  required_columns:
    turismo: ["fecha", "valor", "periodo"]
    economico: ["fecha", "cotizacion"]
    climatico: ["fecha", "temperatura", "precipitacion"]
  
  # Validaciones específicas por tipo de dato
  data_types:
    temporal:
      required_format: "%Y-%m-%d"
      min_date: "2020-01-01"
      max_date: "2024-12-31"
    economico:
      min_value: 0
      max_inflation: 200  # % anual
    turistico:
      min_visitors: 0
      logical_checks: true

# Configuración para agregación temporal
aggregation:
  target_frequency: "monthly"  # Agregar todo a nivel mensual
  target_columns:
    - turistas_no_residentes_mendoza
    - cotizacion_usd_promedio
    - temperatura_promedio_celsius
    - precipitacion_mm
    - ocupacion_hotelera_pct
    - eventos_grandes_cantidad
    - pib_variacion_intermensual

# Variables de entorno por defecto (expandidas)
defaults:
  timeout_seconds: 180  # Aumentado para APIs
  max_retries: 3
  chunk_size: 8192
  
  # APIs externas - configurar como Airflow Variables
  api_keys:
    openweather: "OPENWEATHER_API_KEY"
    worldbank: "WORLDBANK_API_KEY"  # Opcional
    
  # Parámetros de filtrado
  geographic_filters:
    provincia_objetivo: "Mendoza"
    aeropuertos_origen: ["EZE", "AEP", "COR", "MDZ"]
    codigo_provincia: "50"  # Código INDEC Mendoza

  # Configuración de agregación
  date_ranges:
    start_date: "2020-01-01"
    end_date: "2024-12-31"
    prediction_horizon: 12  # meses hacia adelante